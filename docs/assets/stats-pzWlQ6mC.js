import{d as g,r as u,o as k,a as C,w as $,b as v,c as h,t as i,e as T,f as y,g as t,F as b,h as x,u as a,i as V,n as D,j as U}from"./kemov-runtime-dom.esm-bundler-bJRMKtYm.js";import{d as _,a as f,s as p,m as I,u as B}from"./kemov-axios-PefFTsOG.js";import{a as N,w as n}from"./kemov-index-KnQ1S9om.js";import{_ as M}from"./kemov-SiteNavigator.vue_vue_type_style_index_0_lang-K3DjlITZ.js";const j="https://nanase.cc/asset/kemov/channels.json",S="https://s3.ap-northeast-1.amazonaws.com/nanase.asset/kemov/stats.json",Y={key:0,class:"update-time"},z=g({__name:"UpdateTime",props:{time:null},setup(c){const s=u(Number.NaN),l=u();function r(){return s.value>=60?`${Math.floor(s.value/60)}分`:`${s.value}秒`}function d(){s.value=_().diff(c.time,"s")}return k(async()=>{l.value=setInterval(d,1e3)}),C(()=>{clearInterval(l.value)}),$(()=>c.time,d),(m,o)=>c.time.isValid()&&!Number.isNaN(s.value)?(v(),h("div",Y,i(`${c.time.format("YYYY/MM/DD HH:mm:ss")} (${r()}前) 更新`),1)):T("",!0)}}),A={class:"stats-app"},E=t("h1",null,"けもV リアルタイム統計",-1),F={class:"content"},H={class:"vtuber-list"},R=V('<div class="vtuber header"><div class="header avatar"></div><div class="header name"></div><div class="header subscriber-count">チャンネル登録</div><div class="header view-count">総再生回数</div><div class="header video-count">動画数</div></div>',1),L=["href","title"],q=["href","title"],G={class:"subscriber-count"},J={class:"view-count"},K={class:"video-count"},O={class:"vtuber total"},P=t("div",{class:"total avatar"},null,-1),Q=t("div",{class:"total name"},"合計",-1),W={class:"total subscriber-count"},X={class:"total view-count"},Z={class:"total video-count"},tt=t("div",{class:"horizon"},null,-1),et=t("div",{class:"note"},[t("ul",null,[t("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),t("li",null,"総再生回数と動画数は配信終了後から反映されます"),t("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")])],-1),st=g({__name:"StatsApp",setup(c){const s=u([]),l=u(_(Number.NaN)),r=u();let d;N(f,{retries:3,retryDelay:N.exponentialDelay});async function m(){try{const o=(await f.get(S)).data;s.value=I("id",d,o.data),l.value=_.unix(o.fetched_at);const w=Math.floor(6e5-(_().unix()-o.fetched_at)*1e3)+5e3;r.value=setTimeout(m,w)}catch(o){console.error(`Fetching error. Retrying in 10 minutes: ${o}`),r.value=setTimeout(m,6e5)}}return k(async()=>{d=(await f.get(j)).data,await m()}),C(()=>{clearInterval(r.value)}),(o,w)=>(v(),h(b,null,[y(M),t("div",A,[E,t("div",F,[t("div",H,[R,(v(!0),h(b,null,x(s.value,e=>(v(),h("div",{class:"vtuber",key:e.id},[t("a",{class:"avatar",style:D({backgroundImage:a(B)(e.thumbnails.medium.url),borderColor:e.color.key}),href:`https://www.youtube.com/${e.customUrl}`,target:"_blank",title:e.name},null,12,L),t("a",{class:"name",href:`https://www.youtube.com/${e.customUrl}`,target:"_blank",title:e.name},i(e.name),9,q),t("div",G,i(a(n)(e.statistics.subscriberCount)),1),t("div",J,i(a(n)(e.statistics.viewCount)),1),t("div",K,i(a(n)(e.statistics.videoCount)),1)]))),128)),t("div",O,[P,Q,t("div",W,i(a(n)(a(p)(s.value,e=>e.statistics.subscriberCount))),1),t("div",X,i(a(n)(a(p)(s.value,e=>e.statistics.viewCount))),1),t("div",Z,i(a(n)(a(p)(s.value,e=>e.statistics.videoCount))),1)]),y(z,{class:"update-time",time:l.value},null,8,["time"])]),tt,et])])],64))}});U(st).mount("#app");
