import{d as T,m as at,o as u,c as h,w as a,n as st,u as g,a as x,t as b,r as s,b as l,e as w,f as $,g as I,F as S,h as t,i as p,j as A,k as Y,l as nt,p as lt,q as ot}from"./kemov-runtime-dom.esm-bundler-M54MTBvO.js";import{u as rt,c as it,a as ct,d as ut,b as k}from"./kemov-main-M2lcRatM.js";import{w as D,a as z,c as dt,s as mt}from"./kemov-index-P5RyAsfu.js";import{s as H,d as V,a as M,m as vt}from"./kemov-axios--MCeKlca.js";const C=T({__name:"DifferenceValue",props:at({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:["text-green-darken-3"],negativeClass:["text-red-darken-3"],strongClass:["font-weight-bold"],tag:"span"}),setup(e){const i=e.tag;function d(n){return n===0?"":n>0?`+${D(n)}`:`${D(n)}`}function m(n){return n===0?[""]:n>=e.strong?[...e.positiveClass,...e.strongClass]:n<=-e.strong?[...e.negativeClass,...e.strongClass]:n>0?[...e.positiveClass]:[...e.negativeClass]}return(n,v)=>(u(),h(g(i),{class:st(m(n.value))},{default:a(()=>[x(b(d(n.value)),1)]),_:1},8,["class"]))}}),ft=l("th",{class:"pl-4 pr-2"}," ",-1),_t={class:"px-2 text-right font-weight-bold"},pt={key:0,class:"px-2 text-right font-weight-bold"},gt=l("th",{class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1),bt={class:"pl-4 pr-2"},ht={class:"channel-name-text"},yt={class:"px-2 text-h6"},xt={class:"text-right text-h6"},wt=l("td",{class:"pl-4 pr-2 text-body-1 font-weight-bold"},"合計",-1),kt={class:"px-2"},Ct=T({__name:"StatTable",props:{channels:null,type:null},setup(e){function i(){switch(e.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function d(o){switch(e.type){case"subscriber":return o.statistics.subscriberCount;case"view":return o.statistics.viewCount;case"video":return o.statistics.videoCount}}function m(o){switch(e.type){case"subscriber":return o.statistics.subscriberCountPerHour;case"view":return o.statistics.viewCountPerHour;case"video":return o.statistics.videoCountPerHour}}function n(o){switch(e.type){case"subscriber":return o.statistics.subscriberCountPerDay;case"view":return o.statistics.viewCountPerDay;case"video":return o.statistics.videoCountPerDay}}function v(){switch(e.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}return(o,N)=>{const y=s("v-img"),P=s("v-avatar"),_=s("v-list-item"),f=s("v-table");return u(),h(f,{density:"compact",hover:""},{default:a(()=>[l("thead",null,[l("tr",null,[ft,l("th",_t,b(i()),1),e.type==="subscriber"?(u(),w("th",pt,"1時間")):$("",!0),gt])]),l("tbody",null,[(u(!0),w(S,null,I(e.channels,r=>(u(),w("tr",{class:"channel text-right",key:r.id},[l("td",bt,[t(_,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${r.customUrl}`,ripple:!1,slim:!0},{title:a(()=>[l("span",ht,b(r.name),1)]),prepend:a(()=>[t(P,{class:"avatar",color:r.color.key,variant:"outlined",size:"small"},{default:a(()=>[t(y,{src:r.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),l("td",yt,b(g(D)(d(r))),1),e.type==="subscriber"?(u(),h(C,{key:0,class:"px-2 text-h6",value:m(r),strong:v(),tag:"td"},null,8,["value","strong"])):$("",!0),t(C,{class:"pl-2 pr-4 text-h6",value:n(r),strong:v(),tag:"td"},null,8,["value","strong"])]))),128))]),l("tfoot",null,[l("tr",xt,[wt,l("td",kt,b(g(D)(g(H)(e.channels,d))),1),e.type==="subscriber"?(u(),h(C,{key:0,class:"px-2",value:g(H)(e.channels,m),strong:v(),tag:"td"},null,8,["value","strong"])):$("",!0),t(C,{class:"pl-2 pr-4",value:g(H)(e.channels,n),strong:v(),tag:"td"},null,8,["value","strong"])])])]),_:1})}}}),$t={key:0,class:"update-time"},Vt=T({__name:"UpdateTime",props:{time:null},setup(e){const i=p(Number.NaN),d=p();function m(){return i.value>=60?`${Math.floor(i.value/60)}分`:`${i.value}秒`}function n(){i.value=V().diff(e.time,"s")}return A(async()=>{d.value=setInterval(n,1e3)}),Y(()=>{clearInterval(d.value)}),nt(()=>e.time,n),(v,o)=>e.time.isValid()&&!Number.isNaN(i.value)?(u(),w("div",$t,b(`${e.time.format("YYYY/MM/DD HH:mm:ss")} (${m()}前) 更新`),1)):$("",!0)}}),Dt=l("span",{class:"font-weight-bold"},"チャンネル登録者数",-1),Tt=l("span",{class:"font-weight-bold"},"総再生数",-1),Nt=l("span",{class:"font-weight-bold"},"配信・動画数",-1),Pt=l("ul",null,[l("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),l("li",null,"総再生回数と動画数は配信終了後から反映されます"),l("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")],-1),Ut=T({__name:"StatsApp",setup(e){const i=p([]),d=p(V(Number.NaN)),m=p(),n=rt(),v=p("subscriber"),o=p();let N;z(M,{retries:3,retryDelay:z.exponentialDelay});async function y(){try{const _=(await M.get(mt)).data;i.value=vt("id",N,_.data),d.value=V.unix(_.fetched_at);const f=Math.floor(6e5-(V().unix()-_.fetched_at)*1e3)+5e3;m.value=setTimeout(y,f)}catch(_){console.error(`Fetching error. Retrying in 10 minutes: ${_}`),m.value=setTimeout(y,6e5)}}A(async()=>{N=(await M.get(dt)).data,await y()}),Y(()=>{clearInterval(m.value)});function P(){n.global.name.value=n.global.current.value.dark?"light":"dark"}return(_,f)=>{const r=s("v-icon"),U=s("v-list-item"),j=s("v-img"),R=s("v-avatar"),B=s("v-list"),q=s("v-divider"),L=s("v-navigation-drawer"),G=s("v-app-bar-nav-icon"),J=s("v-toolbar-title"),K=s("v-btn"),O=s("v-app-bar"),F=s("v-tab"),Q=s("v-tabs"),W=s("v-card"),X=s("v-container"),Z=s("v-footer"),tt=s("v-main"),et=s("v-app");return u(),h(et,null,{default:a(()=>[t(L,{class:"bg-background",modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=c=>o.value=c),floating:""},{default:a(()=>[t(B,{class:"pb-0 d-flex flex-column fill-height"},{default:a(()=>[t(U,{link:"",title:"リアルタイム統計",href:"/kemov/stats/"},{prepend:a(()=>[t(r,{icon:"mdi-finance",size:"large"})]),_:1}),t(B,{nav:"",link:"","active-class":"bg-primary",density:"compact",class:"flex-grow-1 flex-shrink-1 overflow-auto"},{default:a(()=>[(u(!0),w(S,null,I(i.value,c=>(u(),h(U,{key:c.id,title:c.name,subtitle:c.globalname,href:`./detail/#/${c.id}`},{prepend:a(()=>[t(R,{color:c.color.key,variant:"outlined",size:"small"},{default:a(()=>[t(j,{src:c.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["title","subtitle","href"]))),128))]),_:1}),t(q),t(B,{density:"compact",link:"",nav:"",class:"flex-grow-0 flex-shrink-0"},{default:a(()=>[t(U,{title:"ジェネット楽曲一覧",href:"/kemov/genet/music/","prepend-icon":"mdi-music"},{prepend:a(()=>[t(r,{icon:"mdi-music",size:"small"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(tt,null,{default:a(()=>[t(O,{flat:"",density:"compact"},{append:a(()=>[t(K,{icon:"mdi-theme-light-dark",onClick:P})]),default:a(()=>[t(G,{variant:"text",onClick:f[1]||(f[1]=lt(c=>o.value=!o.value,["stop"]))}),t(J,null,{default:a(()=>[x("けもV リアルタイム統計")]),_:1})]),_:1}),t(X,null,{default:a(()=>[t(Q,{modelValue:v.value,"onUpdate:modelValue":f[2]||(f[2]=c=>v.value=c),color:"primary","align-tabs":"center",density:"compact"},{default:a(()=>[t(F,{value:"subscriber"},{default:a(()=>[t(r,{start:""},{default:a(()=>[x("mdi-account-check")]),_:1}),Dt]),_:1}),t(F,{value:"view"},{default:a(()=>[t(r,{start:""},{default:a(()=>[x("mdi-play")]),_:1}),Tt]),_:1}),t(F,{value:"video"},{default:a(()=>[t(r,{start:""},{default:a(()=>[x("mdi-video")]),_:1}),Nt]),_:1})]),_:1},8,["modelValue"]),t(Ct,{channels:i.value,type:v.value},null,8,["channels","type"]),t(W,{class:"text-right px-4 py-2",variant:"flat"},{default:a(()=>[t(Vt,{class:"update-time",time:d.value},null,8,["time"])]),_:1})]),_:1}),t(Z,{class:"bg-primary text-left d-flex flex-column mt-10"},{default:a(()=>[Pt]),_:1})]),_:1})]),_:1})}}}),Bt=it({components:ct,directives:ut,icons:{defaultSet:"mdi"},theme:{themes:{defaultTheme:"light",light:{dark:!1,colors:{background:"#F4F5FA",primary:k.indigo.base,secondary:k.blue.base}},dark:{dark:!0,colors:{background:"#121212",primary:k.indigo.base,secondary:k.blue.base}}},variations:{colors:["primary","secondary"],lighten:0,darken:0}}}),E=ot(Ut);E.use(Bt);E.mount("#app");
