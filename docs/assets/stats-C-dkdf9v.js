import{d as E,m as Z,o as m,c as V,w as n,n as G,u as v,a as $,t as p,r as l,b as w,e as s,f as h,g as J,F as K,h as e,i as Q,j as N,k as W,l as X,p as tt,q as et,_ as st,s as nt}from"./kemov-_plugin-vue_export-helper-UeGyvY2D.js";import{c as y,a as at,b as ot,d as lt}from"./kemov-main-BkLIkeJF.js";import{u as it,_ as rt,c as ct,s as ut}from"./kemov-config-BW528-FK.js";import{e as C,z as x,d as D,i as A,a as z,Z as dt}from"./kemov-axios-KKTN_JCe.js";const mt={dark:!1,colors:{background:"#F4F5FA",primary:y.indigo.base,secondary:y.indigo.base,positive:y.green.darken3,negative:y.red.darken3}},vt={dark:!0,colors:{background:"#121212",primary:y.indigo.lighten4,secondary:y.indigo.darken4,positive:y.green.lighten2,negative:y.red.lighten1}},ft={themes:{defaultTheme:"light",light:mt,dark:vt},variations:{colors:["primary","secondary","positive","negative"],lighten:0,darken:0}},P=E({__name:"DifferenceValue",props:Z({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:["text-positive"],negativeClass:["text-negative"],strongClass:["font-weight-bold"],tag:"span"}),setup(t){const u=t.tag;function c(i){return i===0?"":i>0?`+${C(i)}`:`${C(i)}`}function g(i){return i===0?[""]:i>=t.strong?[...t.positiveClass,...t.strongClass]:i<=-t.strong?[...t.negativeClass,...t.strongClass]:i>0?[...t.positiveClass]:[...t.negativeClass]}return(i,f)=>(m(),V(v(u),{class:G(g(i.value))},{default:n(()=>[$(p(c(i.value)),1)]),_:1},8,["class"]))}}),gt={key:0},pt={scope:"col",class:"px-2 text-right font-weight-bold"},bt={key:0,scope:"col",class:"px-2 text-right font-weight-bold"},ht={scope:"row",class:"channel-name-head pl-4 pr-2"},yt={class:"channel-name-text"},_t={class:"px-2 text-h6"},xt={key:0},wt={colspan:"4",class:"pa-4 text-center"},Ct={key:1},kt={class:"text-right text-h6"},Vt={scope:"row",class:"pl-4 pr-2 text-right text-body-1 font-weight-bold"},Nt={class:"mt-n4"},$t={class:"mt-n4"},Dt={class:"mt-n4"},St={class:"px-2"},Tt=E({__name:"StatTable",props:{channels:null,type:null,activeOnly:{type:Boolean}},setup(t){function u(){switch(t.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function c(o){switch(t.type){case"subscriber":return o.statistics.subscriberCount;case"view":return o.statistics.viewCount;case"video":return o.statistics.videoCount}}function g(o){switch(t.type){case"subscriber":return o.statistics.subscriberCountPerHour;case"view":return o.statistics.viewCountPerHour;case"video":return o.statistics.videoCountPerHour}}function i(o){switch(t.type){case"subscriber":return o.statistics.subscriberCountPerDay;case"view":return o.statistics.viewCountPerDay;case"video":return o.statistics.videoCountPerDay}}function f(){switch(t.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}function _(o){return o>=1e3?o+10**(BigInt(o).toString().length-3)-1:o}function a(){const o=x(t.channels,c);return Math.round(o+(x(t.channels,r=>_(c(r)))-o)/2)}function b(o){return t.activeOnly&&typeof o.activityEndDate=="string"?D().isBefore(o.activityEndDate):!0}return(o,r)=>{const M=l("v-img"),S=l("v-avatar"),T=l("v-list-item"),F=l("v-progress-circular"),B=l("v-btn"),k=l("v-card-text"),H=l("v-timeline-item"),O=l("v-timeline"),j=l("v-spacer"),I=l("v-card-actions"),R=l("v-card"),q=l("v-dialog"),L=l("v-table");return m(),V(L,{density:"compact",hover:""},{default:n(()=>[t.channels.length!==0?(m(),w("thead",gt,[s("tr",null,[r[0]||(r[0]=s("th",{scope:"col",class:"pl-4 pr-2"}," ",-1)),s("th",pt,p(u()),1),t.type==="subscriber"?(m(),w("th",bt,"1時間")):h("",!0),r[1]||(r[1]=s("th",{scope:"col",class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1))])])):h("",!0),s("tbody",null,[(m(!0),w(K,null,J(t.channels.filter(b),d=>(m(),w("tr",{class:"channel text-right",key:d.id},[s("th",ht,[e(T,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${d.customUrl}`,ripple:!1,slim:""},{title:n(()=>[s("span",yt,p(d.name),1)]),prepend:n(()=>[e(S,{class:"avatar",color:d.color.key,variant:"outlined",size:"small"},{default:n(()=>[e(M,{src:d.thumbnails.default.url,alt:d.fullname},null,8,["src","alt"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),s("td",_t,p(v(C)(c(d))),1),t.type==="subscriber"?(m(),V(P,{key:0,class:"px-2 text-h6",value:g(d),strong:f(),tag:"td"},null,8,["value","strong"])):h("",!0),e(P,{class:"pl-2 pr-4 text-h6",value:i(d),strong:f(),tag:"td"},null,8,["value","strong"])]))),128)),t.channels.length===0?(m(),w("tr",xt,[s("td",wt,[e(F,{color:"primary",indeterminate:""})])])):h("",!0)]),t.channels.length!==0?(m(),w("tfoot",Ct,[s("tr",kt,[s("th",Vt,[t.type==="subscriber"?(m(),V(q,{key:0,"max-width":"640"},{activator:n(({props:d})=>[e(B,Q(d,{icon:"mdi-information-outline",variant:"plain",density:"compact","aria-label":"チャンネル登録者数について"}),null,16)]),default:n(({isActive:d})=>[e(R,{title:"チャンネル登録者数について"},{default:n(()=>[e(k,null,{default:n(()=>r[2]||(r[2]=[s("p",null," YouTube の制約により、チャンネル登録者数の正確な数値はチャンネルの所有者のみに開示されます。 それ以外の利用者には数値の上位3桁のみが開示されます。 ",-1),s("p",null," したがって、このサイトで表示している数値は上位3桁のみの最小値であり、正確な数値はこれ以上となります。 下記の数値は合計値の参考としてお考えください。 ",-1)])),_:1}),e(k,null,{default:n(()=>[e(O,{class:"text-center",direction:"horizontal",side:"end",size:"small",density:"compact"},{default:n(()=>[e(H,{icon:"mdi-flag-checkered","dot-color":"green"},{default:n(()=>[s("div",Nt,[s("p",null,p(v(C)(v(x)(t.channels,c))),1),r[3]||(r[3]=s("div",{class:"font-weight-bold text-body-2"},"最小値",-1))])]),_:1}),e(H,{icon:"mdi-flag-checkered","dot-color":"orange-darken-1"},{default:n(()=>[s("div",$t,[s("p",null,p(v(C)(a())),1),r[4]||(r[4]=s("div",{class:"font-weight-bold text-body-2"},"平均値",-1))])]),_:1}),e(H,{icon:"mdi-flag-checkered","dot-color":"red"},{default:n(()=>[s("div",Dt,[s("p",null,p(v(C)(v(x)(t.channels,U=>_(c(U))))),1),r[5]||(r[5]=s("div",{class:"font-weight-bold text-body-2"},"最大値",-1))])]),_:1})]),_:1})]),_:1}),e(I,null,{default:n(()=>[e(j),e(B,{text:"閉じる",onClick:U=>d.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})):h("",!0),r[6]||(r[6]=$(" 合計 "))]),s("td",St,p(v(C)(v(x)(t.channels,c))),1),t.type==="subscriber"?(m(),V(P,{key:0,class:"px-2",value:v(x)(t.channels,g),strong:f(),tag:"td"},null,8,["value","strong"])):h("",!0),e(P,{class:"pl-2 pr-4",value:v(x)(t.channels,i),strong:f(),tag:"td"},null,8,["value","strong"])])])):h("",!0)]),_:1})}}}),Bt={key:0,class:"update-time"},Pt=E({__name:"UpdateTime",props:{time:null},setup(t){const u=N(Number.NaN),c=W(()=>u.value>=60?`${Math.floor(u.value/60)}分`:`${u.value}秒`);async function g(){return u.value=D().diff(t.time,"s"),1}return A(g),X(()=>t.time,g),(i,f)=>t.time.isValid()&&!Number.isNaN(u.value)?(m(),w("div",Bt,p(`${t.time.format("YYYY/MM/DD HH:mm:ss")} (${c.value}前) 更新`),1)):h("",!0)}}),Et=E({__name:"StatsApp",setup(t){const u=N(),c=N([]),g=N(D(Number.NaN)),i=N("subscriber"),f=it("kemov/stats/activeOnly",!1);return et("streamerChannels",c),A(async()=>{var b;(b=u.value)==null||b.closeErrorSnackbar();const _=(await z.get(ct)).data,a=(await z.get(ut)).data;return c.value=dt("id",_,a.data),g.value=D.unix(a.fetched_at),Math.max(Math.floor(600-(D().unix()-a.fetched_at))+5,30)},async _=>{var a;return console.error(`Fetching error. Retrying in 10 minutes: ${_}`),(a=u.value)==null||a.showErrorSnackbar(),600}),(_,a)=>{const b=l("v-icon"),o=l("v-tab"),r=l("v-tabs"),M=l("v-card"),S=l("v-col"),T=l("v-row"),F=l("v-checkbox"),B=l("v-footer");return m(),V(rt,{ref_key:"appBase",ref:u,"page-id":"stats","toolbar-title":"けもV リアルタイム統計"},{footer:n(()=>[e(B,{class:"bg-secondary text-left d-flex flex-column mt-10"},{default:n(()=>a[8]||(a[8]=[s("ul",null,[s("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),s("li",null,"総再生数と配信・動画数は配信終了後から反映されます"),s("li",null,"このサイトは非公式のファンサイトです")],-1)])),_:1})]),default:n(()=>[e(T,{justify:"center"},{default:n(()=>[e(S,{cols:"12",md:"12",lg:"10",xl:"7",xxl:"6"},{default:n(()=>[e(r,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=k=>i.value=k),color:"primary","align-tabs":"center",density:"compact"},{default:n(()=>[e(o,{value:"subscriber"},{default:n(()=>[e(b,{start:""},{default:n(()=>a[2]||(a[2]=[$("mdi-account-check")])),_:1}),a[3]||(a[3]=s("span",{class:"font-weight-bold"},"チャンネル登録者数",-1))]),_:1}),e(o,{value:"view"},{default:n(()=>[e(b,{start:""},{default:n(()=>a[4]||(a[4]=[$("mdi-play")])),_:1}),a[5]||(a[5]=s("span",{class:"font-weight-bold"},"総再生数",-1))]),_:1}),e(o,{value:"video"},{default:n(()=>[e(b,{start:""},{default:n(()=>a[6]||(a[6]=[$("mdi-video")])),_:1}),a[7]||(a[7]=s("span",{class:"font-weight-bold"},"配信・動画数",-1))]),_:1})]),_:1},8,["modelValue"]),e(Tt,{channels:c.value,type:i.value,"active-only":v(f)},null,8,["channels","type","active-only"]),e(M,{class:"text-right px-4 py-2",variant:"flat"},{default:n(()=>[e(Pt,{class:"update-time",time:g.value},null,8,["time"])]),_:1})]),_:1})]),_:1}),e(T,null,{default:n(()=>[e(S,null,{default:n(()=>[e(F,{modelValue:v(f),"onUpdate:modelValue":a[1]||(a[1]=k=>tt(f)?f.value=k:null),class:"active-only",label:"活動中の配信者のみ表示","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)}}}),Mt=st(Et,[["__scopeId","data-v-e42460f2"]]),Ft=at({components:ot,directives:lt,icons:{defaultSet:"mdi"},theme:ft}),Y=nt(Mt);Y.use(Ft);Y.mount("#app");
