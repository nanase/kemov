import{d as T,m as nt,o as u,c as h,w as e,n as lt,u as g,a as x,t as b,r as a,b as l,e as w,f as $,g as I,F as S,h as t,i as p,j as A,k as Y,l as ot,p as rt,q as it}from"./kemov-runtime-dom.esm-bundler-M54MTBvO.js";import{u as ct,c as ut,a as dt,d as mt,b as k}from"./kemov-main-M2lcRatM.js";import{w as D,a as z,c as vt,s as ft}from"./kemov-index-P5RyAsfu.js";import{s as H,d as V,a as M,m as _t}from"./kemov-axios--MCeKlca.js";const C=T({__name:"DifferenceValue",props:nt({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:["text-green-darken-3"],negativeClass:["text-red-darken-3"],strongClass:["font-weight-bold"],tag:"span"}),setup(s){const i=s.tag;function d(n){return n===0?"":n>0?`+${D(n)}`:`${D(n)}`}function m(n){return n===0?[""]:n>=s.strong?[...s.positiveClass,...s.strongClass]:n<=-s.strong?[...s.negativeClass,...s.strongClass]:n>0?[...s.positiveClass]:[...s.negativeClass]}return(n,v)=>(u(),h(g(i),{class:lt(m(n.value))},{default:e(()=>[x(b(d(n.value)),1)]),_:1},8,["class"]))}}),pt=l("th",{class:"pl-4 pr-2"}," ",-1),gt={class:"px-2 text-right font-weight-bold"},bt={key:0,class:"px-2 text-right font-weight-bold"},ht=l("th",{class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1),yt={class:"pl-4 pr-2"},xt={class:"channel-name-text"},wt={class:"px-2 text-h6"},kt={class:"text-right text-h6"},Ct=l("td",{class:"pl-4 pr-2 text-body-1 font-weight-bold"},"合計",-1),$t={class:"px-2"},Vt=T({__name:"StatTable",props:{channels:null,type:null},setup(s){function i(){switch(s.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function d(o){switch(s.type){case"subscriber":return o.statistics.subscriberCount;case"view":return o.statistics.viewCount;case"video":return o.statistics.videoCount}}function m(o){switch(s.type){case"subscriber":return o.statistics.subscriberCountPerHour;case"view":return o.statistics.viewCountPerHour;case"video":return o.statistics.videoCountPerHour}}function n(o){switch(s.type){case"subscriber":return o.statistics.subscriberCountPerDay;case"view":return o.statistics.viewCountPerDay;case"video":return o.statistics.videoCountPerDay}}function v(){switch(s.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}return(o,N)=>{const y=a("v-img"),P=a("v-avatar"),_=a("v-list-item"),f=a("v-table");return u(),h(f,{density:"compact",hover:""},{default:e(()=>[l("thead",null,[l("tr",null,[pt,l("th",gt,b(i()),1),s.type==="subscriber"?(u(),w("th",bt,"1時間")):$("",!0),ht])]),l("tbody",null,[(u(!0),w(S,null,I(s.channels,r=>(u(),w("tr",{class:"channel text-right",key:r.id},[l("td",yt,[t(_,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${r.customUrl}`,ripple:!1,slim:!0},{title:e(()=>[l("span",xt,b(r.name),1)]),prepend:e(()=>[t(P,{class:"avatar",color:r.color.key,variant:"outlined",size:"small"},{default:e(()=>[t(y,{src:r.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),l("td",wt,b(g(D)(d(r))),1),s.type==="subscriber"?(u(),h(C,{key:0,class:"px-2 text-h6",value:m(r),strong:v(),tag:"td"},null,8,["value","strong"])):$("",!0),t(C,{class:"pl-2 pr-4 text-h6",value:n(r),strong:v(),tag:"td"},null,8,["value","strong"])]))),128))]),l("tfoot",null,[l("tr",kt,[Ct,l("td",$t,b(g(D)(g(H)(s.channels,d))),1),s.type==="subscriber"?(u(),h(C,{key:0,class:"px-2",value:g(H)(s.channels,m),strong:v(),tag:"td"},null,8,["value","strong"])):$("",!0),t(C,{class:"pl-2 pr-4",value:g(H)(s.channels,n),strong:v(),tag:"td"},null,8,["value","strong"])])])]),_:1})}}}),Dt={key:0,class:"update-time"},Tt=T({__name:"UpdateTime",props:{time:null},setup(s){const i=p(Number.NaN),d=p();function m(){return i.value>=60?`${Math.floor(i.value/60)}分`:`${i.value}秒`}function n(){i.value=V().diff(s.time,"s")}return A(async()=>{d.value=setInterval(n,1e3)}),Y(()=>{clearInterval(d.value)}),ot(()=>s.time,n),(v,o)=>s.time.isValid()&&!Number.isNaN(i.value)?(u(),w("div",Dt,b(`${s.time.format("YYYY/MM/DD HH:mm:ss")} (${m()}前) 更新`),1)):$("",!0)}}),Nt=l("span",{class:"font-weight-bold"},"チャンネル登録者数",-1),Pt=l("span",{class:"font-weight-bold"},"総再生数",-1),Ut=l("span",{class:"font-weight-bold"},"配信・動画数",-1),Bt=l("ul",null,[l("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),l("li",null,"総再生回数と動画数は配信終了後から反映されます"),l("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")],-1),Ft=T({__name:"StatsApp",setup(s){const i=p([]),d=p(V(Number.NaN)),m=p(),n=ct(),v=p("subscriber"),o=p();let N;z(M,{retries:3,retryDelay:z.exponentialDelay});async function y(){try{const _=(await M.get(ft)).data;i.value=_t("id",N,_.data),d.value=V.unix(_.fetched_at);const f=Math.floor(6e5-(V().unix()-_.fetched_at)*1e3)+5e3;m.value=setTimeout(y,f)}catch(_){console.error(`Fetching error. Retrying in 10 minutes: ${_}`),m.value=setTimeout(y,6e5)}}A(async()=>{N=(await M.get(vt)).data,await y()}),Y(()=>{clearInterval(m.value)});function P(){n.global.name.value=n.global.current.value.dark?"light":"dark"}return(_,f)=>{const r=a("v-icon"),U=a("v-list-item"),E=a("v-img"),R=a("v-avatar"),B=a("v-list"),q=a("v-divider"),L=a("v-navigation-drawer"),G=a("v-app-bar-nav-icon"),J=a("v-toolbar-title"),K=a("v-btn"),O=a("v-app-bar"),F=a("v-tab"),Q=a("v-tabs"),W=a("v-card"),X=a("v-col"),Z=a("v-row"),tt=a("v-container"),et=a("v-footer"),st=a("v-main"),at=a("v-app");return u(),h(at,null,{default:e(()=>[t(L,{class:"bg-background",modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=c=>o.value=c),floating:""},{default:e(()=>[t(B,{class:"pb-0 d-flex flex-column fill-height"},{default:e(()=>[t(U,{link:"",title:"リアルタイム統計",href:"/kemov/stats/"},{prepend:e(()=>[t(r,{icon:"mdi-finance",size:"large"})]),_:1}),t(B,{nav:"",link:"","active-class":"bg-primary",density:"compact",class:"flex-grow-1 flex-shrink-1 overflow-auto"},{default:e(()=>[(u(!0),w(S,null,I(i.value,c=>(u(),h(U,{key:c.id,title:c.name,subtitle:c.globalname,href:`./detail/#/${c.id}`},{prepend:e(()=>[t(R,{color:c.color.key,variant:"outlined",size:"small"},{default:e(()=>[t(E,{src:c.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["title","subtitle","href"]))),128))]),_:1}),t(q),t(B,{density:"compact",link:"",nav:"",class:"flex-grow-0 flex-shrink-0"},{default:e(()=>[t(U,{title:"ジェネット楽曲一覧",href:"/kemov/genet/music/","prepend-icon":"mdi-music"},{prepend:e(()=>[t(r,{icon:"mdi-music",size:"small"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(st,null,{default:e(()=>[t(O,{flat:"",density:"compact"},{append:e(()=>[t(K,{icon:"mdi-theme-light-dark",onClick:P})]),default:e(()=>[t(G,{variant:"text",onClick:f[1]||(f[1]=rt(c=>o.value=!o.value,["stop"]))}),t(J,null,{default:e(()=>[x("けもV リアルタイム統計")]),_:1})]),_:1}),t(tt,null,{default:e(()=>[t(Z,{justify:"center"},{default:e(()=>[t(X,{cols:"12",md:"12",lg:"10",xl:"7",xxl:"6"},{default:e(()=>[t(Q,{modelValue:v.value,"onUpdate:modelValue":f[2]||(f[2]=c=>v.value=c),color:"primary","align-tabs":"center",density:"compact"},{default:e(()=>[t(F,{value:"subscriber"},{default:e(()=>[t(r,{start:""},{default:e(()=>[x("mdi-account-check")]),_:1}),Nt]),_:1}),t(F,{value:"view"},{default:e(()=>[t(r,{start:""},{default:e(()=>[x("mdi-play")]),_:1}),Pt]),_:1}),t(F,{value:"video"},{default:e(()=>[t(r,{start:""},{default:e(()=>[x("mdi-video")]),_:1}),Ut]),_:1})]),_:1},8,["modelValue"]),t(Vt,{channels:i.value,type:v.value},null,8,["channels","type"]),t(W,{class:"text-right px-4 py-2",variant:"flat"},{default:e(()=>[t(Tt,{class:"update-time",time:d.value},null,8,["time"])]),_:1})]),_:1})]),_:1})]),_:1}),t(et,{class:"bg-primary text-left d-flex flex-column mt-10"},{default:e(()=>[Bt]),_:1})]),_:1})]),_:1})}}}),Ht=ut({components:dt,directives:mt,icons:{defaultSet:"mdi"},theme:{themes:{defaultTheme:"light",light:{dark:!1,colors:{background:"#F4F5FA",primary:k.indigo.base,secondary:k.blue.base}},dark:{dark:!0,colors:{background:"#121212",primary:k.indigo.base,secondary:k.blue.base}}},variations:{colors:["primary","secondary"],lighten:0,darken:0}}}),j=it(Ft);j.use(Ht);j.mount("#app");
