import{d as T,m as O,c as V,n as se,u as i,o as d,w as n,a as I,t as y,b as _,e as r,f as x,r as ne,F as ae,g as t,h as H,i as u,j as J,k as oe,l as re,p as le,q as ie,s as ce,v as ue}from"./kemov-runtime-dom.esm-bundler-DyuC_rl0.js";import{c as h,a as de,b as ve,d as fe,e as me}from"./kemov-main-CdQEV6nj.js";import{t as $,u as K,a as ge,b as pe,c as be,d as _e,_ as ye}from"./kemov-StatsAppBase.vue_vue_type_script_setup_true_lang-Cu82DotR.js";import{g as he,d as B,r as A}from"./kemov-axios-DhS8gzt2.js";const we={dark:!1,colors:{background:"#F4F5FA",primary:h.indigo.base,secondary:h.indigo.base,positive:h.green.darken3,negative:h.red.darken3,v2DrawerBackground:"#ffffff",v2DrawerList:"#3c3c43",v2DrawerListActive:h.indigo.base,v2AppBarBackground:"#ffffff",v2SnackbarBackground:"#171717"},variables:{"high-emphasis-opacity":"1.0","v2-content-color":"#3c3c43","v2-snackbar-border":"none"}},xe={dark:!0,colors:{background:"#121212",primary:h.indigo.lighten4,secondary:h.indigo.darken4,positive:h.green.lighten2,negative:h.red.lighten1,v2DrawerBackground:"#171717",v2DrawerList:"#bcbcbc",v2DrawerListActive:h.blue.lighten2,v2AppBarBackground:"#171717",v2SnackbarBackground:"#171717"},variables:{"high-emphasis-opacity":"0.86","v2-content-color":"rgba(255, 255, 245, .86)","v2-snackbar-border":"1px solid #3c3c43"}},ke={themes:{defaultTheme:"light",light:we,dark:xe},variations:{colors:["primary","secondary","positive","negative"],lighten:0,darken:0}};var P={exports:{}},Ce=P.exports,G;function Se(){return G||(G=1,function(e,a){(function(g,v){e.exports=v()})(Ce,function(){return function(g,v,c){v.prototype.isBetween=function(f,D,l,p){var b=c(f),k=c(D),N=(p=p||"()")[0]==="(",C=p[1]===")";return(N?this.isAfter(b,l):!this.isBefore(b,l))&&(C?this.isBefore(k,l):!this.isAfter(k,l))||(N?this.isBefore(b,l):!this.isAfter(b,l))&&(C?this.isAfter(k,l):!this.isBefore(k,l))}}})}(P)),P.exports}var Be=Se();const De=he(Be),L=T({__name:"DifferenceValue",props:O({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:()=>["text-positive"],negativeClass:()=>["text-negative"],strongClass:()=>["font-weight-bold"],tag:"span"}),setup(e){const a=e.tag;function g(c){return c===0?"":c>0?`+${$(c)}`:`${$(c)}`}function v(c){return c===0?[""]:c>=e.strong?[...e.positiveClass,...e.strongClass]:c<=-e.strong?[...e.negativeClass,...e.strongClass]:c>0?[...e.positiveClass]:[...e.negativeClass]}return(c,f)=>(d(),V(i(a),{class:se(v(c.value))},{default:n(()=>[I(y(g(c.value)),1)]),_:1},8,["class"]))}}),Ae={key:0},$e={scope:"col",class:"px-2 text-right font-weight-bold"},Ve={key:0,scope:"col",class:"px-2 text-right font-weight-bold"},Ie={scope:"row",class:"channel-name-head pl-4 pr-2"},Ne={class:"channel-name-box"},Te={class:"channel-name-text"},Le={key:0,class:"live-badge has-live"},Pe={key:1,class:"live-badge has-live-to-start-soon"},Ee={key:2,class:"live-badge has-live-before-start"},Fe={class:"px-2 text-h6"},Me={key:0},je={colspan:"4",class:"pa-4 text-center"},ze={key:1},He={class:"text-right text-h6"},Oe={scope:"row",class:"pl-4 pr-2 text-right text-body-1 font-weight-bold"},Ue={class:"mt-n4"},Ye={class:"mt-n4"},qe={class:"mt-n4"},Re={class:"px-2"},Ge=T({__name:"StatTable",props:{type:null,activeOnly:{type:Boolean}},setup(e){B.extend(De);const{channels:a,latestStreamings:g}=K(),v=ge({interval:5e3});function c(){switch(e.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function f(o){switch(e.type){case"subscriber":return o.statistics.subscriberCount;case"view":return o.statistics.viewCount;case"video":return o.statistics.videoCount}}function D(o){switch(e.type){case"subscriber":return o.statistics.subscriberCountPerHour;case"view":return o.statistics.viewCountPerHour;case"video":return o.statistics.videoCountPerHour}}function l(o){switch(e.type){case"subscriber":return o.statistics.subscriberCountPerDay;case"view":return o.statistics.viewCountPerDay;case"video":return o.statistics.videoCountPerDay}}function p(){switch(e.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}function b(o){return o>=1e3?o+10**(BigInt(o).toString().length-3)-1:o}function k(){const o=A(a.value,f);return Math.round(o+(A(a.value,s=>b(f(s)))-o)/2)}function N(o){return e.activeOnly&&typeof o.activityEndDate=="string"?B().isBefore(o.activityEndDate):!0}function C(o){const s=g.value.find(w=>w.channelId===o);return typeof s<"u"&&s.success&&s.isLiveBroadcast===!0&&B(v.value).isAfter(s.startedAt)}function E(o){const s=g.value.find(w=>w.channelId===o);return typeof s<"u"&&s.success&&s.isLiveBroadcast===!0&&B(v.value).isBetween(s.startedAt,B(s.startedAt).add(-1,"hour"))}function F(o){const s=g.value.find(w=>w.channelId===o);return typeof s<"u"&&s.success&&s.isLiveBroadcast===!0&&B(v.value).isBetween(s.startedAt,B(s.startedAt).add(-3,"hour"))}return(o,s)=>{const w=u("v-img"),M=u("v-avatar"),S=u("v-list-item"),j=u("v-progress-circular"),Y=u("v-btn"),q=u("v-card-text"),z=u("v-timeline-item"),Q=u("v-timeline"),W=u("v-spacer"),X=u("v-card-actions"),Z=u("v-card"),ee=u("v-dialog"),te=u("v-table");return d(),V(te,{density:"compact",hover:""},{default:n(()=>[i(a).length!==0?(d(),_("thead",Ae,[r("tr",null,[s[0]||(s[0]=r("th",{scope:"col",class:"pl-4 pr-2"}," ",-1)),r("th",$e,y(c()),1),e.type==="subscriber"?(d(),_("th",Ve,"1時間")):x("",!0),s[1]||(s[1]=r("th",{scope:"col",class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1))])])):x("",!0),r("tbody",null,[(d(!0),_(ae,null,ne(i(a).filter(N),m=>(d(),_("tr",{class:"channel text-right",key:m.id},[r("th",Ie,[t(S,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${m.customUrl}`,ripple:!1,slim:""},{title:n(()=>[r("div",Ne,[r("span",Te,y(m.name),1)])]),prepend:n(()=>[C(m.id)?(d(),_("div",Le)):E(m.id)?(d(),_("div",Pe)):F(m.id)?(d(),_("div",Ee)):x("",!0),t(M,{class:"avatar",color:m.color.key,variant:"outlined",size:"small"},{default:n(()=>[t(w,{src:m.thumbnails.default.url,alt:m.fullname},null,8,["src","alt"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),r("td",Fe,y(i($)(f(m))),1),e.type==="subscriber"?(d(),V(L,{key:0,class:"px-2 text-h6",value:D(m),strong:p(),tag:"td"},null,8,["value","strong"])):x("",!0),t(L,{class:"pl-2 pr-4 text-h6",value:l(m),strong:p(),tag:"td"},null,8,["value","strong"])]))),128)),i(a).length===0?(d(),_("tr",Me,[r("td",je,[t(j,{color:"primary",indeterminate:""})])])):x("",!0)]),i(a).length!==0?(d(),_("tfoot",ze,[r("tr",He,[r("th",Oe,[e.type==="subscriber"?(d(),V(ee,{key:0,"max-width":"640"},{activator:n(({props:m})=>[t(Y,H(m,{icon:"mdi-information-outline",variant:"plain",density:"compact","aria-label":"チャンネル登録者数について"}),null,16)]),default:n(({isActive:m})=>[t(Z,{title:"チャンネル登録者数について"},{default:n(()=>[t(q,null,{default:n(()=>s[2]||(s[2]=[r("p",null," YouTube の制約により、チャンネル登録者数の正確な数値はチャンネルの所有者のみに開示されます。 それ以外の利用者には数値の上位3桁のみが開示されます。 ",-1),r("p",null," したがって、このサイトで表示している数値は上位3桁のみの最小値であり、正確な数値はこれ以上となります。 下記の数値は合計値の参考としてお考えください。 ",-1)])),_:1}),t(q,null,{default:n(()=>[t(Q,{class:"text-center",direction:"horizontal",side:"end",size:"small",density:"compact"},{default:n(()=>[t(z,{icon:"mdi-flag-checkered","dot-color":"green"},{default:n(()=>[r("div",Ue,[r("p",null,y(i($)(i(A)(i(a),f))),1),s[3]||(s[3]=r("div",{class:"font-weight-bold text-body-2"},"最小値",-1))])]),_:1}),t(z,{icon:"mdi-flag-checkered","dot-color":"orange-darken-1"},{default:n(()=>[r("div",Ye,[r("p",null,y(i($)(k())),1),s[4]||(s[4]=r("div",{class:"font-weight-bold text-body-2"},"平均値",-1))])]),_:1}),t(z,{icon:"mdi-flag-checkered","dot-color":"red"},{default:n(()=>[r("div",qe,[r("p",null,y(i($)(i(A)(i(a),R=>b(f(R))))),1),s[5]||(s[5]=r("div",{class:"font-weight-bold text-body-2"},"最大値",-1))])]),_:1})]),_:1})]),_:1}),t(X,null,{default:n(()=>[t(W),t(Y,{text:"閉じる",onClick:R=>m.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})):x("",!0),s[6]||(s[6]=I(" 合計 "))]),r("td",Re,y(i($)(i(A)(i(a),f))),1),e.type==="subscriber"?(d(),V(L,{key:0,class:"px-2",value:i(A)(i(a),D),strong:p(),tag:"td"},null,8,["value","strong"])):x("",!0),t(L,{class:"pl-2 pr-4",value:i(A)(i(a),l),strong:p(),tag:"td"},null,8,["value","strong"])])])):x("",!0)]),_:1})}}}),Je={key:0,class:"update-time"},Ke=T({__name:"UpdateTime",props:O({time:null,updateInterval:null},{updateInterval:1e3}),setup(e){const a=J(Number.NaN),g=oe(()=>a.value>=60?`${Math.floor(a.value/60)}分`:`${a.value}秒`);function v(){a.value=B().diff(e.time,"s")}return pe(v,e.updateInterval),re(()=>e.time,v),(c,f)=>c.time.isValid()&&!Number.isNaN(a.value)?(d(),_("div",Je,[le(c.$slots,"default",{readableElapsedTime:g.value},()=>[I(y(g.value),1)])])):x("",!0)}}),Qe=T({__name:"UpdateCircle",props:O({time:null,updateInterval:null,greenSeconds:null,yellowSeconds:null,greenClass:null,yellowClass:null,redClass:null},{updateInterval:2e3,greenSeconds:60,yellowSeconds:()=>60*5,greenClass:"green-darken-2",yellowClass:"yellow-darken-3",redClass:"red-darken-3"}),setup(e){const a=be(()=>e.time,()=>e.updateInterval);function g(){return a.value<e.greenSeconds?e.greenClass:a.value<e.yellowSeconds?e.yellowClass:e.redClass}function v(){return a.value<e.greenSeconds?a.value*(100/e.greenSeconds):a.value<e.yellowSeconds?100-(a.value-e.greenSeconds)*(100/e.yellowSeconds):100}return(c,f)=>{const D=u("v-progress-circular");return d(),V(D,{color:g(),"model-value":v(),size:12,width:6},null,8,["color","model-value"])}}}),We=T({__name:"StatsApp",setup(e){const{fetchedAt:a,fetching:g,errorOccurred:v}=K(),c=J("subscriber"),f=_e("kemov/stats/activeOnly",!1);return ie(async()=>{await g.channels.start(),await g.latestStreamings.start()}),(D,l)=>{const p=u("v-icon"),b=u("v-tab"),k=u("v-tabs"),N=u("v-checkbox"),C=u("v-col"),E=u("v-list-item"),F=u("v-list"),o=u("v-menu"),s=u("v-row"),w=u("v-card"),M=u("v-footer");return d(),V(ye,{"page-id":"stats",title:"けもV リアルタイム統計","error-snackbar-shown":i(v)},{footer:n(()=>[t(M,{class:"bg-secondary text-left d-flex flex-column mt-10"},{default:n(()=>l[8]||(l[8]=[r("ul",null,[r("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),r("li",null,"総再生数と配信・動画数は配信終了後から反映されます"),r("li",null,"このサイトは非公式のファンサイトです")],-1)])),_:1})]),default:n(()=>[t(s,{justify:"center"},{default:n(()=>[t(C,{cols:"12",md:"12",lg:"10",xl:"7",xxl:"6"},{default:n(()=>[t(k,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=S=>c.value=S),color:"primary","align-tabs":"center",density:"compact"},{default:n(()=>[t(b,{value:"subscriber"},{default:n(()=>[t(p,{start:""},{default:n(()=>l[2]||(l[2]=[I("mdi-account-check")])),_:1}),l[3]||(l[3]=r("span",{class:"font-weight-bold"},"チャンネル登録者数",-1))]),_:1}),t(b,{value:"view"},{default:n(()=>[t(p,{start:""},{default:n(()=>l[4]||(l[4]=[I("mdi-play")])),_:1}),l[5]||(l[5]=r("span",{class:"font-weight-bold"},"総再生数",-1))]),_:1}),t(b,{value:"video"},{default:n(()=>[t(p,{start:""},{default:n(()=>l[6]||(l[6]=[I("mdi-video")])),_:1}),l[7]||(l[7]=r("span",{class:"font-weight-bold"},"配信・動画数",-1))]),_:1})]),_:1},8,["modelValue"]),t(Ge,{type:c.value,"active-only":i(f)},null,8,["type","active-only"]),t(w,{class:"text-right px-3 py-0",variant:"flat"},{default:n(()=>[t(s,{"no-gutters":""},{default:n(()=>[t(C,null,{default:n(()=>[t(N,{modelValue:i(f),"onUpdate:modelValue":l[1]||(l[1]=S=>ce(f)?f.value=S:null),label:"活動中の配信者のみ表示","hide-details":"",density:"compact"},null,8,["modelValue"])]),_:1}),t(C,{class:"d-flex align-center justify-end"},{default:n(()=>[t(o,null,{activator:n(({props:S})=>[t(Qe,H({class:"cursor-pointer mr-1"},S,{time:i(a),"update-interval":5e3,"green-seconds":60*10,"yellow-seconds":60*30}),null,16,["time"]),t(Ke,H({class:"cursor-pointer opacity-70 text-subtitle-2"},S,{time:i(a),"update-interval":5e3}),{default:n(({readableElapsedTime:j})=>[I(y(j)+"前 ",1)]),_:2},1040,["time"])]),default:n(()=>[t(F,{density:"compact"},{default:n(()=>[t(E,{slim:"",subtitle:`更新: ${i(a).format("YYYY-MM-DD H:mm:ss")}`},null,8,["subtitle"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["error-snackbar-shown"])}}}),Xe=de({components:fe,directives:me,icons:{defaultSet:"mdi"},theme:ke}),U=ue(We),Ze=ve();U.use(Xe);U.use(Ze);U.mount("#app");
