import{d as P,m as et,o as u,c as x,w as e,n as st,u as h,a as C,t as y,r as a,b as o,e as k,f as D,g as z,F as I,h as t,i as b,j as S,k as A,l as at,p as nt,q as ot}from"./kemov-runtime-dom.esm-bundler-g1_GW4ns.js";import{c as p,a as lt,b as it,d as rt}from"./kemov-main-EqAsrzU9.js";import{w as T,a as M,c as ct,_ as ut,s as dt}from"./kemov-index-XeU5B8Z4.js";import{s as F,d as N,a as H,m as vt}from"./kemov-axios--MCeKlca.js";const mt={dark:!1,colors:{background:"#F4F5FA",primary:p.indigo.base,secondary:p.indigo.base,positive:p.green.darken3,negative:p.red.darken3}},ft={dark:!0,colors:{background:"#121212",primary:p.indigo.lighten4,secondary:p.indigo.darken4,positive:p.green.lighten2,negative:p.red.lighten1}},_t={themes:{defaultTheme:"light",light:mt,dark:ft},variations:{colors:["primary","secondary","positive","negative"],lighten:0,darken:0}},V=P({__name:"DifferenceValue",props:et({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:["text-positive"],negativeClass:["text-negative"],strongClass:["font-weight-bold"],tag:"span"}),setup(s){const i=s.tag;function d(n){return n===0?"":n>0?`+${T(n)}`:`${T(n)}`}function v(n){return n===0?[""]:n>=s.strong?[...s.positiveClass,...s.strongClass]:n<=-s.strong?[...s.negativeClass,...s.strongClass]:n>0?[...s.positiveClass]:[...s.negativeClass]}return(n,r)=>(u(),x(h(i),{class:st(v(n.value))},{default:e(()=>[C(y(d(n.value)),1)]),_:1},8,["class"]))}}),pt=o("th",{class:"pl-4 pr-2"}," ",-1),gt={class:"px-2 text-right font-weight-bold"},bt={key:0,class:"px-2 text-right font-weight-bold"},ht=o("th",{class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1),yt={class:"pl-4 pr-2"},xt={class:"channel-name-text"},wt={class:"px-2 text-h6"},Ct={class:"text-right text-h6"},kt=o("td",{class:"pl-4 pr-2 text-body-1 font-weight-bold"},"合計",-1),$t={class:"px-2"},Vt=P({__name:"StatTable",props:{channels:null,type:null},setup(s){function i(){switch(s.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function d(l){switch(s.type){case"subscriber":return l.statistics.subscriberCount;case"view":return l.statistics.viewCount;case"video":return l.statistics.videoCount}}function v(l){switch(s.type){case"subscriber":return l.statistics.subscriberCountPerHour;case"view":return l.statistics.viewCountPerHour;case"video":return l.statistics.videoCountPerHour}}function n(l){switch(s.type){case"subscriber":return l.statistics.subscriberCountPerDay;case"view":return l.statistics.viewCountPerDay;case"video":return l.statistics.videoCountPerDay}}function r(){switch(s.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}return(l,$)=>{const _=a("v-img"),m=a("v-avatar"),g=a("v-list-item"),w=a("v-table");return u(),x(w,{density:"compact",hover:""},{default:e(()=>[o("thead",null,[o("tr",null,[pt,o("th",gt,y(i()),1),s.type==="subscriber"?(u(),k("th",bt,"1時間")):D("",!0),ht])]),o("tbody",null,[(u(!0),k(I,null,z(s.channels,f=>(u(),k("tr",{class:"channel text-right",key:f.id},[o("td",yt,[t(g,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${f.customUrl}`,ripple:!1,slim:!0},{title:e(()=>[o("span",xt,y(f.name),1)]),prepend:e(()=>[t(m,{class:"avatar",color:f.color.key,variant:"outlined",size:"small"},{default:e(()=>[t(_,{src:f.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),o("td",wt,y(h(T)(d(f))),1),s.type==="subscriber"?(u(),x(V,{key:0,class:"px-2 text-h6",value:v(f),strong:r(),tag:"td"},null,8,["value","strong"])):D("",!0),t(V,{class:"pl-2 pr-4 text-h6",value:n(f),strong:r(),tag:"td"},null,8,["value","strong"])]))),128))]),o("tfoot",null,[o("tr",Ct,[kt,o("td",$t,y(h(T)(h(F)(s.channels,d))),1),s.type==="subscriber"?(u(),x(V,{key:0,class:"px-2",value:h(F)(s.channels,v),strong:r(),tag:"td"},null,8,["value","strong"])):D("",!0),t(V,{class:"pl-2 pr-4",value:h(F)(s.channels,n),strong:r(),tag:"td"},null,8,["value","strong"])])])]),_:1})}}}),Dt={key:0,class:"update-time"},Nt=P({__name:"UpdateTime",props:{time:null},setup(s){const i=b(Number.NaN),d=b();function v(){return i.value>=60?`${Math.floor(i.value/60)}分`:`${i.value}秒`}function n(){i.value=N().diff(s.time,"s")}return S(async()=>{d.value=setInterval(n,1e3)}),A(()=>{clearInterval(d.value)}),at(()=>s.time,n),(r,l)=>s.time.isValid()&&!Number.isNaN(i.value)?(u(),k("div",Dt,y(`${s.time.format("YYYY/MM/DD HH:mm:ss")} (${v()}前) 更新`),1)):D("",!0)}}),Tt=o("span",{class:"font-weight-bold"},"チャンネル登録者数",-1),Pt=o("span",{class:"font-weight-bold"},"総再生数",-1),Ut=o("span",{class:"font-weight-bold"},"配信・動画数",-1),Bt=o("ul",null,[o("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),o("li",null,"総再生回数と動画数は配信終了後から反映されます"),o("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")],-1),Ft=P({__name:"StatsApp",setup(s){const i=b([]),d=b(N(Number.NaN)),v=b(),n=b("subscriber"),r=b();let l;M(H,{retries:3,retryDelay:M.exponentialDelay});async function $(){try{const _=(await H.get(dt)).data;i.value=vt("id",l,_.data),d.value=N.unix(_.fetched_at);const m=Math.floor(6e5-(N().unix()-_.fetched_at)*1e3)+5e3;v.value=setTimeout($,m)}catch(_){console.error(`Fetching error. Retrying in 10 minutes: ${_}`),v.value=setTimeout($,6e5)}}return S(async()=>{l=(await H.get(ct)).data,await $()}),A(()=>{clearInterval(v.value)}),(_,m)=>{const g=a("v-icon"),w=a("v-list-item"),f=a("v-img"),j=a("v-avatar"),U=a("v-list"),E=a("v-divider"),R=a("v-navigation-drawer"),q=a("v-app-bar-nav-icon"),L=a("v-toolbar-title"),G=a("v-app-bar"),B=a("v-tab"),J=a("v-tabs"),K=a("v-card"),O=a("v-col"),Q=a("v-row"),W=a("v-container"),X=a("v-footer"),Z=a("v-main"),tt=a("v-app");return u(),x(tt,null,{default:e(()=>[t(R,{class:"bg-background",modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=c=>r.value=c),floating:""},{default:e(()=>[t(U,{class:"pb-0 d-flex flex-column fill-height"},{default:e(()=>[t(w,{link:"",title:"リアルタイム統計",href:"/kemov/stats/"},{prepend:e(()=>[t(g,{icon:"mdi-finance",size:"large"})]),_:1}),t(U,{nav:"",link:"","active-class":"bg-primary",density:"compact",class:"flex-grow-1 flex-shrink-1 overflow-auto"},{default:e(()=>[(u(!0),k(I,null,z(i.value,c=>(u(),x(w,{key:c.id,title:c.name,subtitle:c.globalname,href:`./detail/#/${c.id}`},{prepend:e(()=>[t(j,{color:c.color.key,variant:"outlined",size:"small"},{default:e(()=>[t(f,{src:c.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["title","subtitle","href"]))),128))]),_:1}),t(E),t(U,{density:"compact",link:"",nav:"",class:"flex-grow-0 flex-shrink-0"},{default:e(()=>[t(w,{title:"ジェネット楽曲一覧",href:"/kemov/genet/music/","prepend-icon":"mdi-music"},{prepend:e(()=>[t(g,{icon:"mdi-music",size:"small"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Z,null,{default:e(()=>[t(G,{flat:"",density:"compact"},{append:e(()=>[t(ut)]),default:e(()=>[t(q,{variant:"text",onClick:m[1]||(m[1]=nt(c=>r.value=!r.value,["stop"]))}),t(L,null,{default:e(()=>[C("けもV リアルタイム統計")]),_:1})]),_:1}),t(W,null,{default:e(()=>[t(Q,{justify:"center"},{default:e(()=>[t(O,{cols:"12",md:"12",lg:"10",xl:"7",xxl:"6"},{default:e(()=>[t(J,{modelValue:n.value,"onUpdate:modelValue":m[2]||(m[2]=c=>n.value=c),color:"primary","align-tabs":"center",density:"compact"},{default:e(()=>[t(B,{value:"subscriber"},{default:e(()=>[t(g,{start:""},{default:e(()=>[C("mdi-account-check")]),_:1}),Tt]),_:1}),t(B,{value:"view"},{default:e(()=>[t(g,{start:""},{default:e(()=>[C("mdi-play")]),_:1}),Pt]),_:1}),t(B,{value:"video"},{default:e(()=>[t(g,{start:""},{default:e(()=>[C("mdi-video")]),_:1}),Ut]),_:1})]),_:1},8,["modelValue"]),t(Vt,{channels:i.value,type:n.value},null,8,["channels","type"]),t(K,{class:"text-right px-4 py-2",variant:"flat"},{default:e(()=>[t(Nt,{class:"update-time",time:d.value},null,8,["time"])]),_:1})]),_:1})]),_:1})]),_:1}),t(X,{class:"bg-secondary text-left d-flex flex-column mt-10"},{default:e(()=>[Bt]),_:1})]),_:1})]),_:1})}}}),Ht=lt({components:it,directives:rt,icons:{defaultSet:"mdi"},theme:_t}),Y=ot(Ft);Y.use(Ht);Y.mount("#app");
