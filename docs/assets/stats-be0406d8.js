import{d as N,r as u,o as k,a as C,w as $,b as v,c as _,t as i,e as x,f as w,g as t,F as b,h as T,u as a,i as V,n as D,j as U}from"./runtime-dom.esm-bundler-729503b1.js";import{d as h,a as p,s as f,m as I,u as B}from"./axios-6631662c.js";import{a as g,w as n}from"./index-7ba0ccea.js";import{_ as M}from"./SiteNavigator.vue_vue_type_style_index_0_lang-b630f976.js";const S="https://nanase.cc/asset/kemov/channels.json",j="https://s3.ap-northeast-1.amazonaws.com/nanase.asset/kemov/stats.json",A={key:0,class:"update-time"},Y=N({__name:"UpdateTime",props:{time:null},setup(c){const s=u(Number.NaN),l=u();function r(){return s.value>=60?`${Math.floor(s.value/60)}分`:`${s.value}秒`}function d(){s.value=h().diff(c.time,"s")}return k(async()=>{l.value=setInterval(d,1e3)}),C(()=>{clearInterval(l.value)}),$(()=>c.time,d),(m,o)=>c.time.isValid()&&!Number.isNaN(s.value)?(v(),_("div",A,i(`${c.time.format("YYYY/MM/DD HH:mm:ss")} (${r()}前) 更新`),1)):x("",!0)}}),z={class:"stats-app"},E=t("h1",null,"けもV リアルタイム統計",-1),F={class:"content"},H={class:"vtuber-list"},R=V('<div class="vtuber header"><div class="header avatar"></div><div class="header name"></div><div class="header subscriber-count">チャンネル登録</div><div class="header view-count">総再生回数</div><div class="header video-count">動画数</div></div>',1),L=["href","title"],q=["href","title"],G={class:"subscriber-count"},J={class:"view-count"},K={class:"video-count"},O={class:"vtuber total"},P=t("div",{class:"total avatar"},null,-1),Q=t("div",{class:"total name"},"合計",-1),W={class:"total subscriber-count"},X={class:"total view-count"},Z={class:"total video-count"},tt=t("div",{class:"horizon"},null,-1),et=t("div",{class:"note"},[t("ul",null,[t("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),t("li",null,"総再生回数と動画数は配信終了後から反映されます"),t("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")])],-1),st=N({__name:"StatsApp",setup(c){const s=u([]),l=u(h(Number.NaN)),r=u();let d;g(p,{retries:3,retryDelay:g.exponentialDelay});async function m(){try{const o=(await p.get(j)).data;s.value=I("id",d,o.data),l.value=h.unix(o.fetched_at);const y=Math.floor(6e5-(h().unix()-o.fetched_at)*1e3)+5e3;r.value=setTimeout(m,y)}catch(o){console.error(`Fetching error. Retrying in 10 minutes: ${o}`),r.value=setTimeout(m,6e5)}}return k(async()=>{d=(await p.get(S)).data,await m()}),C(()=>{clearInterval(r.value)}),(o,y)=>(v(),_(b,null,[w(M),t("div",z,[E,t("div",F,[t("div",H,[R,(v(!0),_(b,null,T(s.value,e=>(v(),_("div",{class:"vtuber",key:e.id},[t("a",{class:"avatar",style:D({backgroundImage:a(B)(e.thumbnails.medium.url),borderColor:e.color.key}),href:`https://www.youtube.com/${e.customUrl}`,target:"_blank",title:e.name},null,12,L),t("a",{class:"name",href:`https://www.youtube.com/${e.customUrl}`,target:"_blank",title:e.name},i(e.name),9,q),t("div",G,i(a(n)(e.statistics.subscriberCount)),1),t("div",J,i(a(n)(e.statistics.viewCount)),1),t("div",K,i(a(n)(e.statistics.videoCount)),1)]))),128)),t("div",O,[P,Q,t("div",W,i(a(n)(a(f)(s.value,e=>e.statistics.subscriberCount))),1),t("div",X,i(a(n)(a(f)(s.value,e=>e.statistics.viewCount))),1),t("div",Z,i(a(n)(a(f)(s.value,e=>e.statistics.videoCount))),1)]),w(Y,{class:"update-time",time:l.value},null,8,["time"])]),tt,et])])],64))}});U(st).mount("#app");
