import{d as P,r as f,o as F,a as B,w as Y,c as p,t as _,b as $,e as v,f as h,g as X,h as y,i as A,j as u,F as S,k as z,u as l,l as K,m as J,_ as Z,n as Q,p as W,s as O,q as ee}from"./axios-b15a7bbb.js";const te="https://raw.githubusercontent.com/nanase/asset/main/kemov/channels.json",ne="https://s3.ap-northeast-1.amazonaws.com/nanase.asset/kemov/stats.json";function m(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const se={key:0,class:"update-time"},re=P({__name:"UpdateTime",props:{time:{}},setup(e){const t=f(Number.NaN),n=f();function s(){return t.value>=60?`${Math.floor(t.value/60)}分`:`${t.value}秒`}function i(){t.value=v().diff(e.time,"s")}return F(async()=>{n.value=setInterval(i,1e3)}),B(()=>{clearInterval(n.value)}),Y(()=>e.time,i),(o,a)=>o.time.isValid()&&!Number.isNaN(t.value)?(h(),p("div",se,_(`${o.time.format("YYYY/MM/DD HH:mm:ss")} (${s()}前) 更新`),1)):$("",!0)}}),ae=new Set(["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED","HOSTNAME_MISMATCH"]);var oe=e=>!ae.has(e&&e.code);const ie=X(oe);function w(e,t,n,s,i,o,a){try{var c=e[o](a),r=c.value}catch(R){n(R);return}c.done?t(r):Promise.resolve(r).then(s,i)}function j(e){return function(){var t=this,n=arguments;return new Promise(function(s,i){var o=e.apply(t,n);function a(r){w(o,s,i,a,c,"next",r)}function c(r){w(o,s,i,a,c,"throw",r)}a(void 0)})}}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L(Object(n),!0).forEach(function(s){ue(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N="axios-retry";function x(e){var t=["ERR_CANCELED","ECONNABORTED"];return!e.response&&!!e.code&&!t.includes(e.code)&&ie(e)}var H=["get","head","options"],ce=H.concat(["put","delete"]);function D(e){return e.code!=="ECONNABORTED"&&(!e.response||e.response.status>=500&&e.response.status<=599)}function le(e){return e.config?D(e)&&H.indexOf(e.config.method)!==-1:!1}function M(e){return e.config?D(e)&&ce.indexOf(e.config.method)!==-1:!1}function q(e){return x(e)||M(e)}function _e(){return 0}function de(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:100,n=Math.pow(2,e)*t,s=n*.2*Math.random();return n+s}function U(e){var t=e[N]||{};return t.retryCount=t.retryCount||0,e[N]=t,t}function Ee(e,t){return b(b({},t),e[N])}function me(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}function fe(e,t,n,s){return C.apply(this,arguments)}function C(){return C=j(function*(e,t,n,s){var i=n.retryCount<e&&t(s);if(typeof i=="object")try{var o=yield i;return o!==!1}catch{return!1}return i}),C.apply(this,arguments)}function d(e,t){var n=e.interceptors.request.use(i=>{var o=U(i);return o.lastRequestTime=Date.now(),i}),s=e.interceptors.response.use(null,function(){var i=j(function*(o){var{config:a}=o;if(!a)return Promise.reject(o);var{retries:c=3,retryCondition:r=q,retryDelay:R=_e,shouldResetTimeout:G=!1,onRetry:V=()=>{}}=Ee(a,t),E=U(a);if(yield fe(c,r,E,o)){E.retryCount+=1;var g=R(E.retryCount,o);if(me(e,a),!G&&a.timeout&&E.lastRequestTime){var k=Date.now()-E.lastRequestTime,I=a.timeout-k-g;if(I<=0)return Promise.reject(o);a.timeout=I}return a.transformRequest=[T=>T],V(E.retryCount,o,a),new Promise(T=>setTimeout(()=>T(e(a)),g))}return Promise.reject(o)});return function(o){return i.apply(this,arguments)}}());return{requestInterceptorId:n,responseInterceptorId:s}}d.isNetworkError=x;d.isSafeRequestError=le;d.isIdempotentRequestError=M;d.isNetworkOrIdempotentRequestError=q;d.exponentialDelay=de;d.isRetryableError=D;const pe={class:"stats-app"},ve=u("h1",null,"けもV リアルタイム統計",-1),he={class:"content"},Re={class:"vtuber-list"},Te=K('<div class="vtuber header"><div class="header avatar"></div><div class="header name"></div><div class="header subscriber-count">チャンネル登録</div><div class="header view-count">総再生回数</div><div class="header video-count">動画数</div></div>',1),ye=["href","title"],Oe=["href","title"],Ne={class:"subscriber-count"},Ce={class:"view-count"},De={class:"video-count"},ge={class:"vtuber total"},Ie=u("div",{class:"total avatar"},null,-1),Ae=u("div",{class:"total name"},"合計",-1),Se={class:"total subscriber-count"},we={class:"total view-count"},Le={class:"total video-count"},be=u("div",{class:"horizon"},null,-1),Ue=u("div",{class:"note"},[u("ul",null,[u("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),u("li",null,"総再生回数と動画数は配信終了後から反映されます"),u("li",null,"このサイトは非公式です。内容についてのお問い合わせはご遠慮ください")])],-1),Pe=P({__name:"StatsApp",setup(e){const t=f([]),n=f(v(Number.NaN)),s=f();let i;d(y,{retries:3,retryDelay:d.exponentialDelay});async function o(){try{const a=(await y.get(ne)).data;t.value=J("id",i,a.data),n.value=v.unix(a.fetched_at);const c=Math.floor(6e5-(v().unix()-a.fetched_at)*1e3)+5e3;s.value=setTimeout(o,c)}catch(a){console.error(`Fetching error. Retrying in 10 minutes: ${a}`),s.value=setTimeout(o,6e5)}}return F(async()=>{i=(await y.get(te)).data,await o()}),B(()=>{clearInterval(s.value)}),(a,c)=>(h(),p(S,null,[A(Z),u("div",pe,[ve,u("div",he,[u("div",Re,[Te,(h(!0),p(S,null,z(t.value,r=>(h(),p("div",{class:"vtuber",key:r.id},[u("a",{class:"avatar",style:Q({backgroundImage:l(W)(r.thumbnails.medium.url),borderColor:r.color.key}),href:`https://www.youtube.com/${r.customUrl}`,target:"_blank",title:r.name},null,12,ye),u("a",{class:"name",href:`https://www.youtube.com/${r.customUrl}`,target:"_blank",title:r.name},_(r.name),9,Oe),u("div",Ne,_(l(m)(r.statistics.subscriberCount)),1),u("div",Ce,_(l(m)(r.statistics.viewCount)),1),u("div",De,_(l(m)(r.statistics.videoCount)),1)]))),128)),u("div",ge,[Ie,Ae,u("div",Se,_(l(m)(l(O)(t.value,r=>r.statistics.subscriberCount))),1),u("div",we,_(l(m)(l(O)(t.value,r=>r.statistics.viewCount))),1),u("div",Le,_(l(m)(l(O)(t.value,r=>r.statistics.videoCount))),1)]),A(re,{class:"update-time",time:n.value},null,8,["time"])]),be,Ue])])],64))}});ee(Pe).mount("#app");
