import{d as T,m as O,o as c,c as k,w as s,n as Q,u as x,a as g,t as w,r as n,b as h,e as l,f as b,g as W,F as X,h as e,i as f,j as I,k as A,l as Z,p as tt,q as et}from"./kemov-runtime-dom.esm-bundler-XfsTaaA0.js";import{c as _,a as st,b as at,d as nt}from"./kemov-main-UmdB_Eur.js";import{w as V,a as S,_ as ot,b as lt,c as rt,s as it}from"./kemov-index-8yuyIOlV.js";import{s as H,d as N,a as M,m as ct}from"./kemov-axios--MCeKlca.js";const ut={dark:!1,colors:{background:"#F4F5FA",primary:_.indigo.base,secondary:_.indigo.base,positive:_.green.darken3,negative:_.red.darken3}},dt={dark:!0,colors:{background:"#121212",primary:_.indigo.lighten4,secondary:_.indigo.darken4,positive:_.green.lighten2,negative:_.red.lighten1}},vt={themes:{defaultTheme:"light",light:ut,dark:dt},variations:{colors:["primary","secondary","positive","negative"],lighten:0,darken:0}},D=T({__name:"DifferenceValue",props:O({value:null,strong:null,positiveClass:null,negativeClass:null,strongClass:null,tag:null},{positiveClass:["text-positive"],negativeClass:["text-negative"],strongClass:["font-weight-bold"],tag:"span"}),setup(t){const i=t.tag;function d(a){return a===0?"":a>0?`+${V(a)}`:`${V(a)}`}function v(a){return a===0?[""]:a>=t.strong?[...t.positiveClass,...t.strongClass]:a<=-t.strong?[...t.negativeClass,...t.strongClass]:a>0?[...t.positiveClass]:[...t.negativeClass]}return(a,u)=>(c(),k(x(i),{class:Q(v(a.value))},{default:s(()=>[g(w(d(a.value)),1)]),_:1},8,["class"]))}}),mt={key:0},ft=l("th",{class:"pl-4 pr-2"}," ",-1),_t={class:"px-2 text-right font-weight-bold"},pt={key:0,class:"px-2 text-right font-weight-bold"},gt=l("th",{class:"pl-2 pr-4 text-right font-weight-bold"},"24時間",-1),ht={class:"pl-4 pr-2"},bt={class:"channel-name-text"},yt={class:"px-2 text-h6"},xt={key:0},wt={colspan:"4",class:"pa-4 text-center"},Ct={key:1},kt={class:"text-right text-h6"},$t=l("td",{class:"pl-4 pr-2 text-body-1 font-weight-bold"},"合計",-1),Dt={class:"px-2"},Nt=T({__name:"StatTable",props:{channels:null,type:null},setup(t){function i(){switch(t.type){case"subscriber":return"登録数";case"view":return"再生数";case"video":return"動画数"}}function d(o){switch(t.type){case"subscriber":return o.statistics.subscriberCount;case"view":return o.statistics.viewCount;case"video":return o.statistics.videoCount}}function v(o){switch(t.type){case"subscriber":return o.statistics.subscriberCountPerHour;case"view":return o.statistics.viewCountPerHour;case"video":return o.statistics.videoCountPerHour}}function a(o){switch(t.type){case"subscriber":return o.statistics.subscriberCountPerDay;case"view":return o.statistics.viewCountPerDay;case"video":return o.statistics.videoCountPerDay}}function u(){switch(t.type){case"subscriber":return 100;case"view":return 1e3;case"video":return 10}}return(o,$)=>{const y=n("v-img"),r=n("v-avatar"),C=n("v-list-item"),U=n("v-progress-circular"),P=n("v-table");return c(),k(P,{density:"compact",hover:""},{default:s(()=>[t.channels.length!==0?(c(),h("thead",mt,[l("tr",null,[ft,l("th",_t,w(i()),1),t.type==="subscriber"?(c(),h("th",pt,"1時間")):b("",!0),gt])])):b("",!0),l("tbody",null,[(c(!0),h(X,null,W(t.channels,m=>(c(),h("tr",{class:"channel text-right",key:m.id},[l("td",ht,[e(C,{class:"channel-name text-left px-0",href:`https://www.youtube.com/${m.customUrl}`,ripple:!1,slim:!0},{title:s(()=>[l("span",bt,w(m.name),1)]),prepend:s(()=>[e(r,{class:"avatar",color:m.color.key,variant:"outlined",size:"small"},{default:s(()=>[e(y,{src:m.thumbnails.default.url},null,8,["src"])]),_:2},1032,["color"])]),_:2},1032,["href"])]),l("td",yt,w(x(V)(d(m))),1),t.type==="subscriber"?(c(),k(D,{key:0,class:"px-2 text-h6",value:v(m),strong:u(),tag:"td"},null,8,["value","strong"])):b("",!0),e(D,{class:"pl-2 pr-4 text-h6",value:a(m),strong:u(),tag:"td"},null,8,["value","strong"])]))),128)),t.channels.length===0?(c(),h("tr",xt,[l("td",wt,[e(U,{color:"primary",indeterminate:""})])])):b("",!0)]),t.channels.length!==0?(c(),h("tfoot",Ct,[l("tr",kt,[$t,l("td",Dt,w(x(V)(x(H)(t.channels,d))),1),t.type==="subscriber"?(c(),k(D,{key:0,class:"px-2",value:x(H)(t.channels,v),strong:u(),tag:"td"},null,8,["value","strong"])):b("",!0),e(D,{class:"pl-2 pr-4",value:x(H)(t.channels,a),strong:u(),tag:"td"},null,8,["value","strong"])])])):b("",!0)]),_:1})}}}),Vt={key:0,class:"update-time"},Tt=T({__name:"UpdateTime",props:{time:null},setup(t){const i=f(Number.NaN),d=f();function v(){return i.value>=60?`${Math.floor(i.value/60)}分`:`${i.value}秒`}function a(){i.value=N().diff(t.time,"s")}return I(async()=>{d.value=setInterval(a,1e3)}),A(()=>{clearInterval(d.value)}),Z(()=>t.time,a),(u,o)=>t.time.isValid()&&!Number.isNaN(i.value)?(c(),h("div",Vt,w(`${t.time.format("YYYY/MM/DD HH:mm:ss")} (${v()}前) 更新`),1)):b("",!0)}}),Ut=l("span",{class:"font-weight-bold"},"チャンネル登録者数",-1),Pt=l("span",{class:"font-weight-bold"},"総再生数",-1),Bt=l("span",{class:"font-weight-bold"},"配信・動画数",-1),Ft=l("ul",null,[l("li",null,"およそ10分ごとに自動で更新されます。数値は減少することがあります"),l("li",null,"総再生数と配信・動画数は配信終了後から反映されます"),l("li",null,"このサイトは非公式のファンサイトです")],-1),Ht=T({__name:"StatsApp",setup(t){const i=f([]),d=f(N(Number.NaN)),v=f(),a=f("subscriber"),u=f(),o=f();S(M,{retries:3,retryDelay:S.exponentialDelay});async function $(){try{o.value=!1;const y=(await M.get(rt)).data,r=(await M.get(it)).data;i.value=ct("id",y,r.data),d.value=N.unix(r.fetched_at);const C=Math.floor(6e5-(N().unix()-r.fetched_at)*1e3)+5e3;v.value=setTimeout($,C)}catch(y){console.error(`Fetching error. Retrying in 10 minutes: ${y}`),o.value=!0,v.value=setTimeout($,6e5)}}return I(async()=>{await $()}),A(()=>{clearInterval(v.value)}),(y,r)=>{const C=n("v-app-bar-nav-icon"),U=n("v-toolbar-title"),P=n("v-app-bar"),m=n("v-btn"),j=n("v-snackbar"),B=n("v-icon"),F=n("v-tab"),E=n("v-tabs"),z=n("v-card"),R=n("v-col"),q=n("v-row"),L=n("v-container"),G=n("v-footer"),J=n("v-main"),K=n("v-app");return c(),k(K,null,{default:s(()=>[e(ot,{opened:u.value,"onUpdate:opened":r[0]||(r[0]=p=>u.value=p),channels:i.value},null,8,["opened","channels"]),e(J,null,{default:s(()=>[e(P,{flat:"",density:"compact"},{append:s(()=>[e(lt)]),default:s(()=>[e(C,{variant:"text",onClick:r[1]||(r[1]=tt(p=>u.value=!u.value,["stop"]))}),e(U,null,{default:s(()=>[g("けもV リアルタイム統計")]),_:1})]),_:1}),e(j,{modelValue:o.value,"onUpdate:modelValue":r[3]||(r[3]=p=>o.value=p),timeout:"10000"},{actions:s(()=>[e(m,{color:"red-lighten-2",variant:"text",onClick:r[2]||(r[2]=p=>o.value=!1)},{default:s(()=>[g("閉じる")]),_:1})]),default:s(()=>[g(" データの読み込みができませんでした。しばらくしてから再読み込みしてください。 ")]),_:1},8,["modelValue"]),e(L,null,{default:s(()=>[e(q,{justify:"center"},{default:s(()=>[e(R,{cols:"12",md:"12",lg:"10",xl:"7",xxl:"6"},{default:s(()=>[e(E,{modelValue:a.value,"onUpdate:modelValue":r[4]||(r[4]=p=>a.value=p),color:"primary","align-tabs":"center",density:"compact"},{default:s(()=>[e(F,{value:"subscriber"},{default:s(()=>[e(B,{start:""},{default:s(()=>[g("mdi-account-check")]),_:1}),Ut]),_:1}),e(F,{value:"view"},{default:s(()=>[e(B,{start:""},{default:s(()=>[g("mdi-play")]),_:1}),Pt]),_:1}),e(F,{value:"video"},{default:s(()=>[e(B,{start:""},{default:s(()=>[g("mdi-video")]),_:1}),Bt]),_:1})]),_:1},8,["modelValue"]),e(Nt,{channels:i.value,type:a.value},null,8,["channels","type"]),e(z,{class:"text-right px-4 py-2",variant:"flat"},{default:s(()=>[e(Tt,{class:"update-time",time:d.value},null,8,["time"])]),_:1})]),_:1})]),_:1})]),_:1}),e(G,{class:"bg-secondary text-left d-flex flex-column mt-10"},{default:s(()=>[Ft]),_:1})]),_:1})]),_:1})}}}),Mt=st({components:at,directives:nt,icons:{defaultSet:"mdi"},theme:vt}),Y=et(Ht);Y.use(Mt);Y.mount("#app");
